<!DOCTYPE html><html><head><script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js"></script><script type="text/javascript" src="../javascripts/jquery.tmpl.min.js"></script><script type="text/javascript" src="../javascripts/flot/jquery.flot.min.js"></script><link rel="stylesheet" href="../stylesheets/benchmarks.css"><title>Alfred.js</title></head><body><div id="header"><h1><a href="../index.html">Alfred</a></h1><p><i>Node is your mansion, Alfred is your butler</i></p><div id="menu"><ul><li><a href="../api.html">API</a></li><li><a href="../examples.html">Examples</a></li><li><a href="../features.html">Features</a></li><li><a href="../internals.html">Internals</a></li><li><a href="../benchmarks.html">Benchmarks</a></li><li><a href="https://github.com/pgte/alfred">Browse source</a></li><li><a href="../index.html">Home</a></li></ul></div></div><div id="main"><div id="container"><div id="internals"><h1>File structure</h1><p>Underneath, Alfred stores each Key Map on an append-only file.</p><p>The file is homogeneous, i.e., each document is written one after the other.</p><h2>Document header</h2><p>On a file, each document starts with a header with 14 bytes.</p><p>The first two bytes are UTF-invalid magic tracker (0xDC80). It can be used, in case there is a corruption detected, to trace the start of the next document.</p><p>The remaining four bytes have the length of the document (ASCII).</p><h2>Document trailer</h2><p>Each document ends with a 40 byte trailer.</p><p>It starts with a 12-byte ASCII-encoded length.</p><p>Then comes a CRC32 checksum of the document.</p><p>In between, the document is serialized in JSON serialized form.</p></div></div><div id="footer">&copy; Pedro Teixeira <a href="http://metaduck.com">Blog</a> &middot; <a href="https://github.com/pgte">GitHub</a> &middot; <a href="http://twitter.com/pedrogteixeira">@pedrogteixeira</a>
</div></div></body></html>